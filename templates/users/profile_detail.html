{% extends 'base.html' %}

{% block title %}User Profile - PayJoint{% endblock %}

{% block extra_head %}
    <style type="text/tailwindcss">
        :root {
            --deep-navy: #000814;
            --royal-blue-dark: #001d3d;
            --royal-blue-medium: #003566;
            --gold-yellow-main: #ffc300;
            --gold-yellow-light: #ffd60a;
            --white: #ffffff;
            --text-muted: #adb5bd;
            --primary-accent: #001d3d; /* Re-using from dashboard context for consistency */
            --secondary-accent: #003566; /* Re-using from dashboard context for consistency */
            --card-bg-light: #0d2850; /* Slightly lighter accent for inner cards/elements */
        }
        body {
            background-color: var(--deep-navy);
            color: var(--white);
            font-family: 'Roboto', sans-serif;
        }
        h1, h2, h3, h4, h5, h6 {
            font-family: 'Montserrat', sans-serif;
        }
        .btn-primary {
            @apply bg-[var(--gold-yellow-main)] text-[var(--deep-navy)] font-semibold hover:bg-[var(--gold-yellow-light)] transition-all duration-300 transform hover:scale-105;
        }
        .btn-secondary {
            @apply bg-[var(--royal-blue-medium)] text-[var(--white)] hover:bg-[var(--royal-blue-dark)] transition-all duration-300 transform hover:scale-105;
        }
        .section-card {
            background-color: var(--primary-accent); /* Main card background */
            @apply rounded-xl shadow-xl;
        }
        .inner-card {
            background-color: var(--card-bg-light); /* Lighter background for elements inside cards */
            @apply rounded-lg p-4;
        }
        .setting-item {
            @apply flex items-center justify-between rounded-lg p-4 transition-colors duration-200 cursor-pointer;
            background-color: var(--royal-blue-dark); /* Item background */
        }
        .setting-item:hover {
            background-color: var(--royal-blue-medium); /* Lighter on hover */
        }
        /* Styles for the custom toggle switch (kept for consistency, even if notifications are removed for now) */
        .toggle-switch {
            @apply relative flex h-7 w-12 cursor-pointer items-center rounded-full p-1;
            background-color: var(--royal-blue-medium);
            transition: background-color 0.3s ease;
        }
        .toggle-switch-handle {
            @apply size-5 rounded-full bg-white transition-transform duration-300 ease-in-out;
        }
        .toggle-switch input:checked + .toggle-switch-handle {
            transform: translateX(100%);
        }
        .toggle-switch input:checked {
             @apply bg-[var(--gold-yellow-main)];
        }
        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-image: linear-gradient(45deg, var(--gold-yellow-main), var(--gold-yellow-light));
        }
    </style>
{% endblock %}

{% block optional_header_content %}
{# No optional header content (nav/auth buttons) on profile detail page, only the default logo from base.html #}
{% endblock optional_header_content %}

{% block content %}
<div class="relative flex min-h-screen flex-col bg-[var(--deep-navy)] overflow-x-hidden">
    {# Main container for content #}
    <main class="flex-1 px-4 sm:px-6 lg:px-8 xl:px-12 py-8">
        <div class="layout-content-container mx-auto flex max-w-4xl flex-col gap-10"> {# Reduced max-width for single column #}

            {# Profile Header / Hero Section #}
            <section class="section-card p-8 sm:p-10 flex flex-col md:flex-row items-center gap-6 bg-gradient-to-r from-[var(--primary-accent)] to-[var(--royal-blue-dark)]">
                <a href="{% url 'groups:dashboard' %}" class="absolute top-6 left-6 text-[var(--gold-yellow-main)] hover:text-[var(--gold-yellow-light)] flex items-center gap-1 transition-colors duration-200">
                    <svg class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                        <path d="M15 18l-6-6 6-6" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    <span class="text-sm hidden sm:inline">Back</span>
                </a>

                <div class="w-32 h-32 sm:w-40 sm:h-40 rounded-full overflow-hidden flex-shrink-0 border-4 border-[var(--gold-yellow-main)] shadow-lg transform transition-transform duration-300 hover:scale-105">
                    {# Male profile picture placeholder #}
                    <img src="https://i.pravatar.cc/160?img=68" alt="Profile Picture" class="w-full h-full object-cover">
                </div>

                <div class="flex flex-col items-center md:items-start text-center md:text-left flex-grow">
                    <h1 class="text-4xl sm:text-5xl font-extrabold tracking-tight text-[var(--white)] leading-tight">
                        {{ user.first_name }} {{ user.last_name }}
                    </h1>
                    <p class="text-xl text-[var(--gold-yellow-light)] mb-2">@{{ user.username }}</p>
                    <p class="text-md text-[var(--text-muted)]">{{ user.email }}</p>
                    <a href="{% url 'users:edit_profile' %}" class="mt-4">
                        <button class="btn-primary rounded-full px-6 py-2 text-sm font-bold uppercase">
                            Edit Profile
                        </button>
                    </a>
                </div>
            </section>

            {# Main Content: Settings #}
            <div class="grid grid-cols-1 gap-8"> {# Changed to a single column grid #}
                {# Settings Section #}
                <section class="section-card p-6">
                    <h2 class="text-2xl font-bold mb-6 border-b border-[var(--royal-blue-dark)] pb-3 text-[var(--white)]">Settings</h2>
                    <div class="space-y-3">
                        <a class="setting-item" href="#">
                            <div class="flex items-center gap-3">
                                <div class="bg-[var(--royal-blue-medium)] p-2 rounded-full flex-shrink-0"><svg fill="currentColor" height="20px" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg"><path d="M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96ZM208,208H48V96H208V208Zm-68-56a12,12,0,1,1-12-12A12,12,0,0,1,140,152Z"></path></svg></div>
                                <span class="text-[var(--text-primary)]">Privacy & Security</span>
                            </div>
                            <svg class="w-5 h-5 text-[var(--text-muted)]" fill="currentColor" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg">
                                <path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path>
                            </svg>
                        </a>
                        <a class="setting-item" href="#">
                            <div class="flex items-center gap-3">
                                <div class="bg-[var(--royal-blue-medium)] p-2 rounded-full flex-shrink-0"><svg fill="currentColor" height="20px" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg"><path d="M140,180a12,12,0,1,1-12-12A12,12,0,0,1,140,180ZM128,72c-22.06,0-40,16.15-40,36v4a8,8,0,0,0,16,0v-4c0-11,10.77-20,24-20s24,9,24,20-10.77,20-24,20a8,8,0,0,0-8,8v8a8,8,0,0,0,16,0v-.72c18.24-3.35,32-17.9,32-35.28C168,88.15,150.06,72,128,72Zm104,56A104,104,0,1,1,128,24,104.11,104.11,0,0,0,232,128Zm-16,0a88,88,0,1,0-88,88A88.1,88.1,0,0,0,216,128Z"></path></svg></div>
                                <span class="text-[var(--text-primary)]">Help & Support</span>
                            </div>
                            <svg class="w-5 h-5 text-[var(--text-muted)]" fill="currentColor" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg">
                                <path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path>
                            </svg>
                        </a>
                        <a class="setting-item" href="#">
                            <div class="flex items-center gap-3">
                                <div class="bg-[var(--royal-blue-medium)] p-2 rounded-full flex-shrink-0"><svg fill="currentColor" height="20px" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg"><path d="M224,128a8,8,0,0,1-8,8H176a8,8,0,0,1-8-8V80a8,8,0,0,1,8-8h40a8,8,0,0,1,8,8Z"></path><path d="M160,192H48a16,16,0,0,1-16-16V64A16,16,0,0,1,48,48H160a16,16,0,0,1,16,16v88A16,16,0,0,1,160,192Zm-24-92a12,12,0,1,0-12,12A12,12,0,0,0,136,100Z"></path></svg></div>
                                <span class="text-[var(--text-primary)]">Payment Methods</span>
                            </div>
                            <svg class="w-5 h-5 text-[var(--text-muted)]" fill="currentColor" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg">
                                <path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path>
                            </svg>
                        </a>
                        {# Logout Button - now part of the main settings column #}
                        <div class="mt-8 pt-4 border-t border-[var(--royal-blue-dark)]"> {# Separator for logout #}
                            <a id="logout-link" class="setting-item text-[var(--gold-yellow-main)] hover:text-[var(--gold-yellow-light)]" href="{% url 'account_logout' %}">
                                <div class="bg-[var(--royal-blue-medium)] p-2 rounded-full flex-shrink-0"><svg fill="currentColor" height="20px" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg"><path d="M112,216a8,8,0,0,1-8,8H48a16,16,0,0,1-16-16V48A16,16,0,0,1,48,32h56a8,8,0,0,1,0,16H48V208h56A8,8,0,0,1,112,216Zm109.66-93.66-40-40a8,8,0,0,0-11.32,11.32L196.69,120H104a8,8,0,0,0,0,16h92.69l-26.35,26.34a8,8,0,0,0,11.32,11.32l40-40A8,8,0,0,0,221.66,122.34Z"></path></svg></div>
                                <span class="font-bold text-lg">Logout</span>
                                <svg class="w-5 h-5 text-[var(--gold-yellow-main)]" fill="currentColor" viewBox="0 0 256 256" width="20px" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M181.66,133.66l-80,80a8,8,0,0,1-11.32-11.32L164.69,128,90.34,53.66a8,8,0,0,1,11.32-11.32l80,80A8,8,0,0,1,181.66,133.66Z"></path>
                                </svg>
                            </a>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </main>
</div>

{# Logout Confirmation Modal #}
<div id="logout-modal" class="fixed inset-0 z-50 hidden flex items-center justify-center bg-black bg-opacity-75 p-4">
    <div class="bg-[var(--primary-accent)] rounded-2xl p-8 shadow-xl max-w-sm w-full text-center border border-[var(--secondary-accent)]">
        <h3 class="text-2xl font-bold text-[var(--text-primary)] mb-4">Confirm Logout</h3>
        <p class="text-[var(--text-muted)] mb-6">Are you sure you want to log out?</p>
        <div class="flex justify-center gap-4">
            <button id="cancel-logout" class="btn-secondary px-6 py-2 rounded-lg">Cancel</button>
            <button id="confirm-logout" class="bg-red-600 text-[var(--white)] hover:bg-red-700 px-6 py-2 rounded-lg font-semibold transition-colors duration-300">Logout</button>
        </div>
    </div>
</div>

{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
  var logoutLink = document.getElementById('logout-link');
  var modal = document.getElementById('logout-modal');
  var confirmBtn = document.getElementById('confirm-logout');
  var cancelBtn = document.getElementById('cancel-logout');

  if (logoutLink && modal && confirmBtn && cancelBtn) {
    logoutLink.addEventListener('click', function(e) {
      e.preventDefault(); // Prevent default link navigation
      modal.classList.remove('hidden'); // Show the modal
    });

    confirmBtn.addEventListener('click', function() {
      // User confirmed, proceed with logout
      window.location.href = logoutLink.href;
    });

    cancelBtn.addEventListener('click', function() {
      modal.classList.add('hidden'); // Hide the modal
    });

    // Close modal if clicked outside of it
    modal.addEventListener('click', function(e) {
        if (e.target === modal) { // Only close if clicking on the modal backdrop, not the modal content itself
            modal.classList.add('hidden');
        }
    });
  }
});
</script>
{% endblock %}